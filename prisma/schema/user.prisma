model User {
  id String @id @default(uuid())

  name     String? @default("Unnamed User")
  email    String  @unique
  password String // hashed password 

  username   String   @unique // auto-generated, updatable once
  employeeId BigInt   @unique @default(autoincrement()) // auto-increment employee number
  role       UserRole @default(EMPLOYEE)

  avatarId String?
  avatar   FileInstance? @relation(fields: [avatarId], references: [id], onDelete: SetNull)

  // HR relations
  department   Department? @relation(fields: [departmentId], references: [id], onDelete: SetNull)
  departmentId String?

  jobTitle   JobTitle? @relation(fields: [jobTitleId], references: [id], onDelete: SetNull)
  jobTitleId String?

  // Logout tracking
  isLoggedIn   Boolean   @default(false)
  lastLoginAt  DateTime?
  lastLogoutAt DateTime?

  // Account status
  isActive          Boolean @default(true)
  isBanned          Boolean @default(false)
  isUsernameUpdated Boolean @default(false)

  // Chats
  privateMessage                 PrivateMessage[]
  privateMessageStatus           PrivateMessageStatus[]
  privateCallInitiator           PrivateCall[]
  privateConversationParticipant PrivateConversationParticipant[]
  privateCallParticipant         PrivateCallParticipant[]

  // Notifications
  notifications UserNotification[]

  // Refresh Tokens
  refreshTokens RefreshToken[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@index([role])
  @@index([isActive, isBanned])
  @@map("users")
}

enum UserRole {
  OWNER // created once on sign up, cannot be deleted/demoted
  SUPER_ADMIN // delegated by owner
  ADMIN
  EMPLOYEE
}
