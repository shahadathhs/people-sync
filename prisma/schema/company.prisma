model Company {
  id   String @id @default(uuid())
  name String @unique

  branches Branch[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  User      User[]

  @@map("companies")
}

model Branch {
  id   String @id @default(uuid())
  name String

  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId String

  departments Department[]
  managers    User[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@unique([companyId, name]) // branch name unique per company
  @@map("branches")
}

model Department {
  id   String @id @default(uuid())
  name String

  branch   Branch @relation(fields: [branchId], references: [id], onDelete: Cascade)
  branchId String

  designations Designation[]
  employees    User[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@unique([branchId, name]) // department unique per branch
  @@map("departments")
}

model Designation {
  id   String @id @default(uuid())
  name String

  department   Department @relation(fields: [departmentId], references: [id], onDelete: Cascade)
  departmentId String

  employees User[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@unique([departmentId, name])
  @@map("designations")
}
